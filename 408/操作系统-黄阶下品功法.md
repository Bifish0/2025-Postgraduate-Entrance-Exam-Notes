# ==操作系统-黄阶下品功法==

> 《操作系统-黄阶下品功法》的修炼主要旨在重点、简略，其在对于功法的全方位了解以及拥有一个较为稳固基础的认知，不追求<u>精细的描述与记录【参考功法秘籍】</u>。
>
> ~对于此功法后续会进行改进。~

## 操作系统的概念

![image-20241023175049603](https://s1.vika.cn/space/2025/06/27/5950a3cd722b4ff199b40ecc4199d91d)

<font color='red'>操作系统</font>（Operating System，OS）是指控制和<font color='red'>管理</font>整个计算机系统的<font color='red'>硬件和软件</font>资源，并合理地组织调度计算机的工作和资源的分配；以<font color='red'>提供给用户和其他软件方便的接口和环境</font>；它是计算机系统中最基本的<font color='red'>系统软件</font>。

```txt
###
1、操作系统是系统资源的管理者
2、向上层提供方便易用的服务
3、操作系统是最接近硬件的一层软件
```

![image-20241023175727001](https://s1.vika.cn/space/2025/06/27/8f8fb19f72d04e2f9919c68cd85a0211)

## 操作系统的功能和目标

### 作为系统资源的管理者

![image-20241023175938947](https://s1.vika.cn/space/2025/06/27/3ae881de782749d7b5287352fdf9ae39)

补充知识：执行一个程序前<font color='red'>需要将该程序放到内存中</font>，才能被CPU处理。

![image-20241023180122242](https://s1.vika.cn/space/2025/06/27/2e35c7463fdf48cf9e8ca5b083556861)

### 向上层提供方便易用的服务

![image-20241023180316477](https://s1.vika.cn/space/2025/06/27/035b74051f3c479baae08da3bc91f5b8)

GUI：图像化用户接口（Graphical User Interface）

<font color='red'>联机命令接口</font>实例（Windows系统）    联机命令接口 = <font color='red'>交互式</font>命令接口

<font color='red'>脱机命令接口</font>实例（Windows系统）     脱机命令接口 = <font color='red'>批处理</font>命令接口

![image-20241023180927021](https://s1.vika.cn/space/2025/06/27/2f821034436346c4a4ed2e7098e1bc47)

 程序接口：可以在程序中进行<font color='red'>系统调用</font>来使用程序接口。普通用户不能直接使用程序接口，只能通过程序代码<font color='red'>间接</font>使用。

==在有的教材中：==系统调用 = <font color='red'>广义指令</font>

![image-20241023181327188](https://s1.vika.cn/space/2025/06/27/34fa0a9ce0d84b0ca5e745df95f9b060)

### 作为最接近硬件的层次

![image-20241023181507402](https://s1.vika.cn/space/2025/06/27/90b17219fcff4fc1a3e6be62ee7480bf)

## ==知识回顾与重要考点==

![image-20241023181531918](https://s1.vika.cn/space/2025/06/27/5340149a69864f1684bd174ee11e1e34)

## 1.1.1+1.1.3 操作系统的特征

~~~text
并发、共享、虚拟、异步
~~~

![image-20241023181715238](https://s1.vika.cn/space/2025/06/27/f5d4280e831c48fc913ee6e1d7000765)

### 并发

<font color='red'>并发</font>：指两个或多个事件在同一时间间隔内发生。这些事件<font color='red'>宏观上是同时发生</font>的，但 <font color='red'>微观上是交替发生</font> 的。常考易混概念——并行：指两个或多个事件在同一时刻同时发生。

![image-20241023182011876](https://s1.vika.cn/space/2025/06/27/4d0d449f1c334d1c840cc27d8c369941)

<font color='red'>操作系统的并发性 </font>指计算机系统中“同时”运行着多个程序，这些程序宏观上看是同时运行着的，而微观上看是交替运行的。

操作系统就是伴随着“多道程序技术”而出现的。因此，操<font color='red'>作系统和程序并发是一起诞生的</font>。

==注意（<font color='red'>重要考点</font>）：==

```
单核CPU同一时刻只能执行一个程序，各个程序只能并发地执行
多核CPU同一时刻可以同时执行多个程序，多个程序可以并行地执行
```

==并发性是操作系统一个最基本的特性==

### 共享

<font color='red'>共享 </font>即资源共享，是指系统中的资源可供内存中多个并发执行的进程共同使用。![image-20241023182740793](https://s1.vika.cn/space/2025/06/27/e39700808dbd4f9f846543cdbf42c7d5)

所谓的“同时”往往是宏观上的，而在微观上，这些进程可能是交替地对该资源进行访问的（即分时共享）

![image-20241023182827136](https://s1.vika.cn/space/2025/06/27/0bdea8e07cb3480187a663e631e33e39)

### 并发和共享的关系

<font color='red'>并发性</font> 指计算机系统中同时存在着多个运行着的程序。

<font color='red'>共享性</font> 是指系统中的资源可供内存中多个并发执行的进程共同使用。

![image-20241023183153733](https://s1.vika.cn/space/2025/06/27/7dd5c8f9c5a5433ca560b37ab32e1a71)

### 虚拟

<font color='red'>虚拟</font> 是指把一个物理上的实体变为若干个逻辑上的对应物。物理实体（前者）是实际存在的，而逻辑上对应物（后者）是用户感受到的。

![image-20241023183445805](https://s1.vika.cn/space/2025/06/27/17636052d89f49c88d3fdf5d4c968208)

![image-20241023183525068](https://s1.vika.cn/space/2025/06/27/56c2590519e64ff1b3bf67ae75b9d042)

![image-20241023183634852](https://s1.vika.cn/space/2025/06/27/92e4b3473a6646d9aca6b90b50d8ff42)

### 异步

<font color='red'>异步</font> 是指，在多道程序环境下，允许多个程序并发执行，但由于资源有限，进程的执行不是一贯到底的，而是走走停停，以不可预知的速度向前推进，这就是进程的异步性。![image-20241023184032996](https://s1.vika.cn/space/2025/06/27/beb8a5abdea3415694bd08a24dea9515)

## ==知识回顾与重要考点==

![image-20241023184323214](https://s1.vika.cn/space/2025/06/27/1b3ddf68d17147e0ad3d59d7aec318b3)

## 1.1.2 操作系统的发展与分类

![image-20241023184439522](https://s1.vika.cn/space/2025/06/27/e0f10ff410a14e0a8529cf39795e9ce3)

### 手工操作阶段

![image-20241023184702623](https://s1.vika.cn/space/2025/06/27/d0dc57582cb54902ba08eb9ca1ffe055)

### 批处理阶段——单道批处理系统

![image-20241023184920024](https://s1.vika.cn/space/2025/06/27/6954fbc44107474aa3cc3c3727f9c0f4)



### 批处理阶段——多道批处理系统

![image-20241023185113037](https://s1.vika.cn/space/2025/06/27/c4a30fe859214814adb7bbe117e7feb8)

### 分时操作系统

![image-20241023185308616](https://s1.vika.cn/space/2025/06/27/eaea4bc519904dd2b27b1382ccd37afb)

分时操作系统：计算机以<font color='red'>时间片</font>为单位<font color='red'>轮流为各个用户/作业服务</font>，各个用户可通过终端与计算机进行交互。

**主要优点：**用户请求可以被即时响应，<font color='red'>解决了人机交互问题</font>。允许多个用户同时使用一台计算机，并且用户对计算机的操作相互独立，感受不到别人的存在。

**主要缺点：**<font color='red'>不能优先处理一些紧急任务</font>。操作系统对各个用户/作业都是完全公平的，循环地为每个用户/作业服务一个时间片，不能区分任务的紧急性。

### 实时操作系统

**主要优点：**能够优先响应一些紧急任务，某些紧急任务不需要时间片排队。

在实时操作系统的控制下，计算机系统接收到外部信号后及时进行处理，并且<font color='red'>要在严格的时限内处理完事件</font>。实时操作系统的主要特点是<font color='red'>及时性和可靠性</font>。

![image-20241023185845944](https://s1.vika.cn/space/2025/06/27/c66317324786402fa6ef71344e913708)

### 其他几种操作系统

![image-20241023185909663](C:/Users/17946/AppData/Roaming/Typora/typora-user-images/image-20241023185909663.png)

## ==知识回顾与重要考点==

![image-20241023185945902](https://s1.vika.cn/space/2025/06/27/eaa3243d944045edb0f3949776ffb048)



# 1.2 操作系统的发展与分类

~~~text
手工操作阶段 -> 批处理阶段(单道批处理系统、多道批处理系统[操作系统开始出现]) -> 分时操作系统 -> 实时操作系统

###
学习提示：要重点关注和理解各类操作系统主要想解决的是什么问题，各自的优缺点
~~~

# 1.3.1 操作系统的运行机制

~~~text
###
“小黑框” ——> 交互式命令接口
“指令” ——> 二进制机器指令

###
内核(Kernel)是操作系统最重要最核心的部分
~~~

<font color='red'><u>**知识点**</u></font>

~~~text
内核程序 V.S. 应用程序
~~~

## 内核态 vs. 用户态

CPU有两种状态，“<font color='red'>内核态</font>”和“<font color='red'>用户态</font>”

- 处于<font color='red'>内核态</font>时，说明此时正在运行的是内核程序，此时可以执行特权指令
- 处于<font color='red'>用户态</font>时，说明此时正在运行的是应用程序，此时只能执行非特权指令

拓展：CPU中有一个寄存器叫 **<font color='red'>程序状态寄存器（PSW）</font>**，其中有个二进制位，1表示“内核态”，0表示“用户态”

别名：内核态=核心态=<font color='red'>管态</font>；用户态=<font color='red'>目态</font>

## 内核态、用户态的切换

<u>==**选择题考察**==</u>

![image-20250204152845112](https://s1.vika.cn/space/2025/06/27/93394aa6f812473c9c41c49f1d74b9e4)

# 1.3.2 中断和异常

~~~text
###
中断的类型：内中断("异常")、外中断("中断")
内中断：1、陷阱、陷入(trap)；2、故障(fault)；3、终止(abort)
外中断：1、时钟中断；2、I/O中断请求

陷入指令：一个特殊的指令，不是 特权指令
    “系统调用”就是通过陷入指令完成的
    
    
#
中断向量表
~~~

## 中断的作用

CPU上会运行两种程序，一种是<font color='red'>操作系统内核程序</font>，一种是<font color='red'>应用程序</font>

“中断”是让<font color='red'>操作系统内核夺回CPU使用权</font>的<u>**唯一途径**</u>

![image-20250204153537654](https://s1.vika.cn/space/2025/06/27/767ecfd5b72b402f968f75dbbea997d3)

## 中断的类型

- **内中断：**与当前执行的指令<font color='red'>有关</font>，中断信号来源于CPU<font color='red'>内部</font>
- **外中断：**与当前执行的指令<font color='red'>无关</font>，中断信号来源于CPU<font color='red'>外部</font>

## 中断机制的基本原理

- ##### 检查中断信号

  > **内中断：**CPU在执行指令时会检查是否有异常发生
  >
  > **外中断：**每个指令周期末尾，CPU都会检查是否有外中断信号需要处理

- ##### 找到相应的中断处理程序

  > 通过<u>**“中断向量表”**</u>实现

![image-20250204155522899](https://s1.vika.cn/space/2025/06/27/68975b656f6143858f542c55eed4bc7e)

**中断处理程序**一定是内核程序，需要运行在“内核态”

# 1.3.3 系统调用

~~~text
###
系统调用
系统调用的过程

陷入指令=trap指令=访管指令
~~~

## 什么是系统调用，有何作用？

“系统调用”：可以理解为一种可供应用程序调用的特殊函数，<font color='red'>应用程序可以通过系统调用来请求获得操作系统内核的服务</font>。

## 什么功能要用到系统调用？

应用程序通过**<font color='red'>系统调用</font>**请求操作系统的服务。而系统中的各种共享资源都由操作系统内核统一掌管，因此<font color='red'>凡是与共享操作有关的操作（如存储分配、I/O操作、文件管理等），都必须通过系统调用的方式向操作系统内核提出服务请求</font>，由操作系统内核代为完成。这样**<font color='red'>可以保证系统的稳定性和安全性</font>**，防止用户进行非法操作。

## 系统调用的过程

1. <font color='red'>陷入指令</font>是在<font color='red'>用户态</font>执行的，执行陷入指令之后立即引发一个<font color='red'>内中断</font>，使CPU进行<font color='red'>核心态</font>
2. <font color='red'>发出系统调用请求</font>是在<font color='red'>用户态</font>，而<font color='red'>对系统调用的相应处理</font>在<font color='red'>核心态</font>下进行

# 1.4 操作系统体系结构

~~~text
大内核(又名：宏内核/单内核)
微内核
大内核与微内核的优缺点


###
原语(特殊程序、原子性)
~~~

## 操作系统的内核

<font color='red'>内核</font>是操作系统最基本、最核心的部分。

实现操作系统内核功能的那些程序就是<font color='red'>内核程序</font>。

![image-20250205005308601](https://s1.vika.cn/space/2025/06/27/76fb9786b27946dc816b0128abd22c11)

## 操作系统的体系结构

- **大内核：**<font color='red'>两次</font>CPU状态的转换
- **微内核：**<font color='red'>六次</font>CPU状态的转换

`注意：CPU状态转换的过程是有成本的，要消耗不少时间，频繁地转换CPU状态会降低系统性能`

~~~text
#
大内核：将操作系统的主要功能模块都作为系统内核，运行在核心态
	优点：高性能
	缺点：内核代码庞大，结构混乱，难以维护
微内核：只把最基本的功能保留在内核
	优点：内核功能少，结构清晰，方便维护
	缺点：需要频繁地在核心态和用户态之间切换，性能低
	
###
新增考点：分层结构、模块化、外核
~~~

- 典型的大内核/宏内核/单内核 操作系统：**Linux、UNIX**
- 典型的 微内核 操作系统：**Windows NT**

Tip：一定是==**考简单的选择题**==，了解各种体系结构的<font color='red'>特性</font>，了解各自的<font color='red'>优缺点</font>

![image-20250205214602050](https://s1.vika.cn/space/2025/06/27/0a23df6c7a384836a606dd295f44f785)

# 1.5 操作系统引导

~~~text
###
主存：
	RAM:通常说的“内存”
	ROM(BIOS)包含:ROM引导程序，即自举程序
BIOS:Basic Input/Output System

#
操作系统初始化程序(即 启动管理器):Windows/Boot/*
~~~

# 1.6 虚拟机

~~~text
###
(选择题)第一类VMM和第二类VMM的区别
~~~

## 虚拟机

虚拟机：使用虚拟化技术，将一台物理机器虚拟化为多台**虚拟机器（Virtual Machine, VM）**，每个虚拟机器都可以独立运行一个操作系统

<u>**同义术语：**</u>虚拟机管理程序 / 虚拟机监控程序 / Virtual Machine Monitor / Hypervisor

![image-20250205222753393](https://s1.vika.cn/space/2025/06/27/59501f53167a4957a37b12078b651b48)

# 2.1.1+2 进程的概念、组成、特征

~~~text
###
程序是如何运行的？
~~~

## 进程的概念

**程序：**是<font color='red'>静态的</font>，就是个存放在磁盘里的可执行文件，就是一系列的指令集合。

**进程（Process）：**是<font color='red'>动态的</font>，是程序的一次执行过程 ~同一个程序多次执行会对应多个进程~

## 进程的组成 —— PCB

> **<u>==PCB是进程存在的唯一标志==</u>**，当进程被创建时，操作系统为其创建PCB，当进程结束时，会回收其PCB

当进程被创建时，操作系统会为该进程分配一个**<font color='red'>唯一的、不重复</font>**的“身份证号” —— **<font color='red'>PID</font>**（Process ID，进行ID）

<u>操作系统要记录PID、进行所属用户ID（UID）</u>

**……**      这些信息都被保存在一个数据结构**<font color='red'>PCB</font>（Process Control Block）**中，即<font color='red'>进程控制块</font>，操作系统需要对各个并发运行的进程进行管理，<font color='red'>但凡管理时所需要的信息，都会被放在PCB中</font>

## 进程的组成 —— 程序段、数据段

<font color='red'>PCB</font> 是 <font color='red'>给操作系统用的</font>。

<font color='red'>程序段、数据段</font>是<font color='red'>给进程自己用的</font>。

> 一个<font color='red'>进程实体（进程映像）</font>由<font color='red'>PCB、程序段、数据段</font>组成。
>
> <font color='red'>进程</font>是<font color='red'>动态</font>的，<font color='red'>进程实体（进程映像）</font>是<font color='red'>静态</font>的。
>
> 进程实体反应了进程在某一时刻的状态（如：x++后，x=2）

## 进程的特征

- ##### 动态性

  - 动态性是进程**最基本的特征**

- ##### 并发性

- ##### 独立性

  - 进程是能独立运行、**独立获得资源、独立接受调度的基本单位**

- ##### 异步性

  - 异步性会导致并发程序执行结果的不确定性。

- ##### 结构性

# 2.1.3 进程的状态与转换

~~~text
###

~~~

## 进程的状态 —— 创建态、就绪态

进程正在被创建时，它的状态是“<font color='red'>创建态</font>”

当进程创建完成后，便进入“<font color='red'>就绪态</font>”

## 进程的状态 —— 运行态

如果一个进程此时在CPU上运行，那么这个进程处于“<font color='red'>运行态</font>”。CPU会执行该进程对应的程序**（执行指令序列）**

## 进程的状态 —— 阻塞态

在进程运行的过程中，可能会<font color='red'>请求等待某个事件的发生</font>

在这个事件发生之前，进程无法继续往下执行，此时操作系统会让这个进程下CPU，并让它进入“<font color='red'>阻塞态</font>”。当CPU空闲时，又会选择另一个”就绪态“进程上CPU运行。

## 进程的状态 —— 终止态

一个进程可以执行**exit系统调用**，请求操作系统终止该进程。

此时该进程会进入”<font color='red'>终止态</font>“，操作系统会让该进程下CPU，并回收内存空间等资源，最后还要回收该进程的PCB。

当终止进程的工作完成之后，这个进程就彻底消失了。

## 进程状态的转换

> **<font color='red'>进程五状态模型</font>**

![image-20250215194011378](https://s1.vika.cn/space/2025/06/27/ed84d671d0674ff7b3ae3a2ace23e291)

## 进程的状态

![image-20250215194132744](https://s1.vika.cn/space/2025/06/27/72ad4147e3624bcebf42507f8f104442)

## 进程的组织

- ##### 链接方式

- ##### 索引方式

# 2.1.4 进程控制

~~~text
###
进程控制 就是要实现进程状态转换

#
用原语来实现“一气呵成”

？思考：为何进程控制（状态转换）的过程要“一气呵成”？
	如果不能“一气呵成”，就有可能导致操作系统中的某些关键数据结构信息不统一的情况，这会影响操作系统进行别的管理工作
	

~~~

`进程控制相关的原语：进程的创建、进程的终止、进程的阻塞、进程的唤醒、进程的切换`

## 如何实现进程控制？

> **用”原语“实现**

**<font color='red'>原语</font>**是一种特殊的程序，它的<font color='red'>执行具有原子性</font>。也就是说，这段程序的<font color='red'>运行必须一气呵成，不可中断</font>

> [考研408《操作系统》复习笔记，第六章《进程》_408进程间通信-CSDN博客](https://blog.csdn.net/m0_73991249/article/details/144030936)

## 如何实现原语的“原子性”？

~~~text
###
思考：如果这两个特权指令允许用户程序使用的话，会发生什么情况？
~~~

可以使用“<font color='red'>关中断</font>指令”和“<font color='red'>开中断</font>指令”这两个<font color='red'>特权指令</font>实现原子性。

<font color='red'>内核程序</font>，运行在**<font color='red'>核心态</font>**。

## 进程控制相关的原语

~~~text
###
“考试的时候不会默写这些东西，以理解为主”
“简答题”
~~~

- #### 进程的创建

  ![image-20250219081611836](https://s1.vika.cn/space/2025/06/27/3d920f3d75b546e09bf686feb01004ab)

- #### 进程的终止

  ![image-20250219082008635](https://s1.vika.cn/space/2025/06/27/b75fde9b91b44772afac81aa9af5d065)

- #### 进程的阻塞和唤醒

  > **唤醒原语**和**阻塞原语**必须是成对使用的。

  ![image-20250219082321487](https://s1.vika.cn/space/2025/06/27/6b8b71779ec34596ac5786589df1d762)

- #### 进程的切换

  ![image-20250219082524849](https://s1.vika.cn/space/2025/06/27/8d0bb28722c24819a7cd6efc492ff183)

